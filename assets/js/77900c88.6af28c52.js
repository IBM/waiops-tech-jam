"use strict";(self.webpackChunkswat_hub=self.webpackChunkswat_hub||[]).push([[9821],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>m});var o=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),s=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},g=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),g=r,m=d["".concat(c,".").concat(g)]||d[g]||u[g]||a;return n?o.createElement(m,i(i({ref:t},p),{},{components:n})):o.createElement(m,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=g;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}g.displayName="MDXCreateElement"},52909:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var o=n(58168),r=(n(96540),n(15680));const a={title:"3. Set up the Netcool Connector",description:"Set up the Netcool Connector in AIOps",sidebar_position:3},i=void 0,l={unversionedId:"cloud-pak-aiops/migration-from-netcool/netcool-connector/index",id:"cloud-pak-aiops/migration-from-netcool/netcool-connector/index",title:"3. Set up the Netcool Connector",description:"Set up the Netcool Connector in AIOps",source:"@site/labs/cloud-pak-aiops/migration-from-netcool/3-netcool-connector/index.mdx",sourceDirName:"cloud-pak-aiops/migration-from-netcool/3-netcool-connector",slug:"/cloud-pak-aiops/migration-from-netcool/netcool-connector/",permalink:"/waiops-tech-jam/labs/cloud-pak-aiops/migration-from-netcool/netcool-connector/",draft:!1,editUrl:"https://github.com/IBM/waiops-tech-jam/tree/main/labs/cloud-pak-aiops/migration-from-netcool/3-netcool-connector/index.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"3. Set up the Netcool Connector",description:"Set up the Netcool Connector in AIOps",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"2. Lab Environment",permalink:"/waiops-tech-jam/labs/cloud-pak-aiops/migration-from-netcool/lab-environment/"},next:{title:"4. Set up the Netcool/Impact Connector",permalink:"/waiops-tech-jam/labs/cloud-pak-aiops/migration-from-netcool/impact-connector/"}},c={},s=[{value:"3.1: Overview",id:"31-overview",level:2},{value:"3.2: Create a Netcool Connector instance",id:"32-create-a-netcool-connector-instance",level:2},{value:"Configure ObjectServer",id:"configure-objectserver",level:3},{value:"Add integration",id:"add-integration",level:3},{value:"Collect event data",id:"collect-event-data",level:3},{value:"3.3: Clear the events in Netcool/OMNIbus",id:"33-clear-the-events-in-netcoolomnibus",level:2},{value:"3.4: View the Alerts viewer",id:"34-view-the-alerts-viewer",level:2},{value:"3.5 Add custom fields to your view",id:"35-add-custom-fields-to-your-view",level:2}],p={toc:s},d="wrapper";function u(e){let{components:t,...a}=e;return(0,r.yg)(d,(0,o.A)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h2",{id:"31-overview"},"3.1: Overview"),(0,r.yg)("p",null,"In this Lab, you will create an instance of the Netcool Connector to connect to an existing Netcool/OMNIbus ObjectServer. Most, if not all, AIOps deployments will include Netcool/OMNIbus components, including Probes and ObjectServers. Creating and configuring the Netcool Connector therefore is usually going to be a key part of any AIOps set-up."),(0,r.yg)("p",null,"This lab will include the tasks of creating and configuring the Netcool Connector instance, adding custom Netcool/OMNIbus fields to the mapping, and then updating the Alerts viewer View to include a custom attribute."),(0,r.yg)("h2",{id:"32-create-a-netcool-connector-instance"},"3.2: Create a Netcool Connector instance"),(0,r.yg)("p",null,"Use the following steps to create an instance of the Netcool Connector:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Log in to the AIOps console and select ",(0,r.yg)("strong",{parentName:"li"},"Integrations")," from the main menu"),(0,r.yg)("li",{parentName:"ul"},"Click the ",(0,r.yg)("strong",{parentName:"li"},"Add integration")," button to add a new integration"),(0,r.yg)("li",{parentName:"ul"},"Type ",(0,r.yg)("strong",{parentName:"li"},"Netcool")," into the Search bar"),(0,r.yg)("li",{parentName:"ul"},"Choose ",(0,r.yg)("strong",{parentName:"li"},"IBM Netcool Operations Insight ObjectServer")," and click ",(0,r.yg)("strong",{parentName:"li"},"Get started")," to create a new instance")),(0,r.yg)("h3",{id:"configure-objectserver"},"Configure ObjectServer"),(0,r.yg)("p",null,"The first part of the Netcool Connector instance configuration, is to prepare the ObjectServer to be connected to by AIOps. This involves adding a few fields and a trigger that facilitates the two-way update mechanism between AIOps and Netcool."),(0,r.yg)("p",null,"Open a command terminal, connect to the ObjectServer VM via SSH, and log in to the ObjectServer:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"ssh netcool@netcoolvm\n$OMNIHOME/bin/nco_sql -server AGG_P -user root -password netcool\n")),(0,r.yg)("p",null,"Copy and paste the following SQL into the SQL prompt:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"alter table alerts.status add column ScopeID varchar(255);\ngo\n\nalter table alerts.status add column AIOpsAlertId varchar(64);\ngo\n\nalter table alerts.status add column AIOpsState varchar(16);\ngo\n\ncreate or replace trigger group NetcoolConnectorAutomation;\ngo\n\nalter trigger group NetcoolConnectorAutomation set enabled true;\ngo\n\nCREATE OR REPLACE TRIGGER netcool_connector_closed_alerts\nGROUP NetcoolConnectorAutomation\nPRIORITY 15\nCOMMENT 'Netcool Connector handle closed alerts in AIOps'\nAFTER UPDATE ON alerts.status\nFOR EACH ROW\nWHEN get_prop_value('ActingPrimary') %= 'TRUE' and\n    new.AIOpsState = 'closed'\nbegin\n\n    delete from alerts.status via new.Identifier;\nend;\ngo\n")),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"In a production environment, this SQL would need to be added to both the primary and backup ObjectServers. In this lab however, we will only be using a single primary ObjectServer.")),(0,r.yg)("h3",{id:"add-integration"},"Add integration"),(0,r.yg)("p",null,"This next step involves the setting up the connection details for the target ObjectServer. In a production scenario, you would enter the details for both the primary and the backup. In this lab, we will only be using the primary."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Name"),": the label you want to give this integration instance"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Description"),": an optional description to give this instance"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Deployment options"),": Choose a ",(0,r.yg)("strong",{parentName:"li"},"Local")," instance (deployed on the OpenShift cluster)"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Admin username"),": enter ",(0,r.yg)("inlineCode",{parentName:"li"},"root")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Admin password"),": enter ",(0,r.yg)("inlineCode",{parentName:"li"},"netcool")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Filters"),": clear the contents of this box (ie. leave it blank)"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Is TLS enabled?"),': leave set to "No"'),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Hostname"),": Enter: ",(0,r.yg)("inlineCode",{parentName:"li"},"netcoolvm")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Port"),": enter: ",(0,r.yg)("inlineCode",{parentName:"li"},"4100")),(0,r.yg)("li",{parentName:"ul"},"Click the ",(0,r.yg)("strong",{parentName:"li"},"Test connection")," button and verify the connection is OK"),(0,r.yg)("li",{parentName:"ul"},"Click the ",(0,r.yg)("strong",{parentName:"li"},"Next")," button to continue")),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"In a production environment, we would enter the connection details for both the primary and backup ObjectServers. In this lab however, we will only be using a single primary ObjectServer.")),(0,r.yg)("h3",{id:"collect-event-data"},"Collect event data"),(0,r.yg)("p",null,"This final step is where you configure the mapping between ObjectServer fields and AIOps. Replace the mapping shown with the following mapping instead:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'(\n  $isIPAddr := function($i){ $contains($i,/^[0-9]+.[0-9]+.[0-9]+.[0-9]+$/)};\n  $isProblem := function($v) { $v = 1 or $v = 3 or $v = 20 or ($v >= 7 and $v < 20) or $v = 0 };\n  $isResolution := function($v) { $v = 2 or $v = 4 or $v = 21 };\n  $isInformation := function($v) { $v = 13 }; \n  { \n    "summary": alert.@Summary,\n    "deduplicationKey": alert.@Identifier,\n    "sender": {\n        "service": alert.@Agent ? alert.@Agent : undefined,\n        "name": alert.@Manager ? alert.@Manager : alert.@ServerName,\n        "connectorType": "netcool",\n        "managedBySender": "true"\n    },\n    "resource": {\n        "name": alert.@Node = "" ? alert.@NodeAlias = "" ? undefined : alert.@NodeAlias : alert.@Node,\n        "location": alert.@Location = "" ? undefined : alert.@Location,\n        "ipAddress": $isIPAddr(alert.@NodeAlias) ? alert.@NodeAlias : $isIPAddr(alert.@Node) ? alert.@Node : undefined,\n        "hostname": $not($isIPAddr(alert.@Node)) ? alert.@Node : undefined,\n        "sourceId": alert.@NodeAlias = "" ? undefined : alert.@NodeAlias,\n        "service": alert.@Service = "" ? undefined : alert.@Service,\n        "port": alert.@PhysicalPort = 0 ? undefined : alert.@PhysicalPort,\n        "physicalslot": alert.@PhysicalSlot = 0 ? undefined : alert.@PhysicalSlot,\n        "physicalcard": alert.@PhysicalCard = "" ? undefined : alert.@PhysicalCard,\n        "scopeId": alert.@ScopeID = "" ? undefined : alert.@ScopeID\n    },\n    "type": {\n        "eventType": alert.@Type = 2 ? "resolution" : alert.@Type = 4 ? "resolution" : "problem",\n        "classification": alert.@EventId = "" ? alert.@AlertGroup: alert.@EventId\n    },\n    "eventCount": alert.@Tally,\n    "signature": alert.@Identifier,\n    "firstOccurrenceTime": alert.@FirstOccurrence,\n    "lastOccurrenceTime": alert.@LastOccurrence,\n    "severity": $isInformation(alert.@Type) ? 2 : alert.@Severity < 0 ? 1 : alert.@Severity = 0 ? 2 : alert.@Severity < 6 ? alert.@Severity + 1 : alert.@Severity >= 6 ? 6,\n    "state": alert.@Severity = 0 ? (alert.@AIOpsAlertId = "" ? "open" : "clear") : "open",\n    "acknowledged": alert.@Acknowledged = 1 ? true : false,\n    "expirySeconds": alert.@ExpireTime = 0 ? undefined : alert.@ExpireTime,\n    "suppressed": alert.@SuppressEscl = 4 ? true : false,\n    "details": {\n        "alertGroup": alert.@AlertGroup,\n        "alertKey": alert.@AlertKey,\n        "customer": alert.@Customer = "" ? undefined : alert.@Customer,\n        "appId": alert.@AppID = "" ? undefined : alert.@AppID,\n        "region": alert.@Region = "" ? undefined : alert.@Region\n    },\n    "insights": [\n      {\n        "details": {\n          "lastProcessedEventOccurrenceTime": alert.@LastOccurrence\n        },\n        "id": "event-occurrence",\n        "type": "aiops.ibm.com/insight-type/deduplication-details"\n      }\n    ]\n  }\n)\n')),(0,r.yg)("p",null,"Click ",(0,r.yg)("strong",{parentName:"p"},"Save")," to save and create the Netcool Connector instance."),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Custom fields are added as sub-attributes of the ",(0,r.yg)("inlineCode",{parentName:"p"},"details")," attribute. In the above example, we are mapping the Netcool/OMNIbus custom fields ",(0,r.yg)("inlineCode",{parentName:"p"},"@AppId")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"@Region")," to AIOps attributes, and hard-coding a further attribute ",(0,r.yg)("inlineCode",{parentName:"p"},"details.alertOrigin"),' to "OMNIbus" for events coming through this integration.')),(0,r.yg)("h2",{id:"33-clear-the-events-in-netcoolomnibus"},"3.3: Clear the events in Netcool/OMNIbus"),(0,r.yg)("p",null,"The Netcool Connector won't pick up any events that already exist in the ObjectServer. For this reason, it is important to clear the contents of the ObjectServer and start with a clean slate."),(0,r.yg)("p",null,"Open a command terminal, connect to the ObjectServer VM via SSH, and log in to the ObjectServer:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"ssh netcool@netcoolvm\n$OMNIHOME/bin/nco_sql -server AGG_P -user root -password netcool\n")),(0,r.yg)("p",null,"Copy and paste the following SQL into the SQL prompt:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"delete from alerts.status;\ngo\n")),(0,r.yg)("h2",{id:"34-view-the-alerts-viewer"},"3.4: View the Alerts viewer"),(0,r.yg)("p",null,"The final confirmation step is to log in to AIOps and inspect the ",(0,r.yg)("strong",{parentName:"p"},"Alerts viewer"),"."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Log in to the AIOps console and select ",(0,r.yg)("strong",{parentName:"li"},"Alerts")," from the main menu"),(0,r.yg)("li",{parentName:"ul"},"View the alerts coming through from Netcool/OMNIbus"),(0,r.yg)("li",{parentName:"ul"},"Double-click one of the alerts and inspect some of the attributes as defined in the Netcool Connector mapping")),(0,r.yg)("p",null,(0,r.yg)("img",{src:n(92e3).A,width:"1154",height:"562"})),(0,r.yg)("h2",{id:"35-add-custom-fields-to-your-view"},"3.5 Add custom fields to your view"),(0,r.yg)("p",null,"Finally, you will add your custom-mapped fields to your Alerts viewer ",(0,r.yg)("strong",{parentName:"p"},"View"),". To do this, click on the ",(0,r.yg)("strong",{parentName:"p"},"View configuration")," button, then select ",(0,r.yg)("strong",{parentName:"p"},"Manage selected view"),". Type in the name of the field in the ",(0,r.yg)("strong",{parentName:"p"},"Search and select a column")," box and check the ones you want to add:"),(0,r.yg)("p",null,(0,r.yg)("img",{src:n(54025).A,width:"1072",height:"733"})),(0,r.yg)("p",null,"Next, drag the field so it is in the correct order in the View. Finally, set the column heading, justification, and size in the ",(0,r.yg)("strong",{parentName:"p"},"Configure selected columns")," box:"),(0,r.yg)("p",null,(0,r.yg)("img",{src:n(85498).A,width:"1074",height:"904"})),(0,r.yg)("p",null,"Click ",(0,r.yg)("strong",{parentName:"p"},"Save")," to save your update and inspect the result in the Alerts viewer:"),(0,r.yg)("p",null,(0,r.yg)("img",{src:n(82764).A,width:"893",height:"234"})))}u.isMDXComponent=!0},85498:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/add_field-609c0e0b0c50c2885eb3d66afc992978.png"},82764:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/alert_viewer_custom_field-9eb5eaa2f8ccd1a37be19bc5cdd34b1b.png"},92e3:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/alerts_viewer-fe3427f87a90519c502534350717b33a.png"},54025:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/search_field-dabee4af1943da5367ab5f900e6d22d8.png"}}]);